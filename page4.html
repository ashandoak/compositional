<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Compositionality — Page 4</title>
  <link rel="stylesheet" href="assets/style.css"/>
</head>

<body data-page="4" data-prev="page3.html" data-next="page5.html">
  <div class="app">
    <div class="top">
      <h1>The same logic can be expressed two ways</h1>
      <div class="sub">Compare the loop-based “do everything” approach with a compositional “build it from parts” approach.</div>
    </div>

    <!-- Page 4 layout wrapper -->
    <div class="main page4-grid">
      <div class="page4-spacer"></div>

      <!-- Centered hero column -->
      <div class="panel page4-hero">
        <div class="panel-body">
          <!-- Two side-by-side code boxes -->
          <div class="page4-codegrid">
            <!-- Left: imperative -->
            <div class="page4-codecol">
              <div class="page4-subhead">Loop-based (imperative)</div>
              <div class="codebox" id="L_code">
                <div class="line hl" data-map="setup"><span class="gutter">1</span><span class="content">nums = [1,2,3,4,5,6]</span></div>
                <div class="line"><span class="gutter">2</span><span class="content"></span></div>
                <div class="line hl" data-map="loop"><span class="gutter">3</span><span class="content">result = []</span></div>
                <div class="line hl" data-map="loop"><span class="gutter">4</span><span class="content">for x in nums:</span></div>
                <div class="line hl" data-map="predicate"><span class="gutter">5</span><span class="content">    if x % 2 == 0:</span></div>
                <div class="line hl" data-map="transform"><span class="gutter">6</span><span class="content">        result.append(x * 10)</span></div>
                <div class="line"><span class="gutter">7</span><span class="content"></span></div>
                <div class="line hl" data-map="reduce"><span class="gutter">8</span><span class="content">print(sum(result))</span></div>
              </div>

            </div>

            <!-- Right: compositional -->
            <div class="page4-codecol">
              <div class="page4-subhead">Compositional (functional)</div>
              <div class="codebox" id="R_code">
                <div class="line hl" data-map="setup"><span class="gutter">1</span><span class="content">nums = [1,2,3,4,5,6]</span></div>
                <div class="line"><span class="gutter">2</span><span class="content"></span></div>
                <div class="line hl" data-map="predicate"><span class="gutter">3</span><span class="content">evens = filter(is_even, nums)</span></div>
                <div class="line hl" data-map="transform"><span class="gutter">4</span><span class="content">tens = map(times_ten, evens)</span></div>
                <div class="line hl" data-map="reduce"><span class="gutter">5</span><span class="content">print(sum(tens))</span></div>
                <div class="line"><span class="gutter">6</span><span class="content"></span></div>
                <div class="line hl" data-map="functions"><span class="gutter">7</span><span class="content">def is_even(x): return x % 2 == 0</span></div>
                <div class="line hl" data-map="functions"><span class="gutter">8</span><span class="content">def times_ten(x): return x * 10</span></div>
              </div>

            </div>
          </div>
        </div>
      </div>

      <div class="page4-spacer"></div>
    </div>

    <!-- Explanation BELOW the hero -->
    <div class="page4-explain-wrap">
      <div class="panel page4-explain">
        <div class="panel-body">
          <div class="page4-footer-row">
          </div>

          <div class="explain" id="explain">
            Click a highlighted line to see what it represents.
          </div>
        </div>
      </div>
    </div>

   <div class="bottom">
      <div class="btnrow">
        <button id="backBtn">◀ Back</button>
      </div>
      <div class="btnrow">
        <button id="nextBtn" class="btn-next">Next ▶</button>
      </div>
    </div>

    <div id="toast" class="toast" role="status" aria-live="polite"></div>
 
  </div>
  <script src="assets/nav.js"></script>
<script>
  // ======= Page 4 interaction logic (existing behavior preserved) =======
  const explain = document.getElementById("explain");

  const midLeft = document.getElementById("midLeft");
  const midRight = document.getElementById("midRight");
  const toggleMid = document.getElementById("toggleMid");

  const nums = [1,2,3,4,5,6];

  function is_even(x){ return x % 2 === 0; }
  function times_ten(x){ return x * 10; }

  const evens = nums.filter(is_even);
  const tens  = evens.map(times_ten);
  const result = [];
  for (const x of nums) {
    if (is_even(x)) result.push(times_ten(x));
  }

  const EXPL = {
    setup: "Setup: we start from the same input list on both sides.",
    loop: "Loop scaffolding: the imperative version mixes selection, transformation, and collection in one place.",
    predicate: "Predicate: a boolean test that decides which items flow forward (here: evens).",
    transform: "Transform: a function that changes each passing value (here: multiply by 10).",
    reduce: "Reduce/aggregate: combine many values into one output (here: sum).",
    functions: "Small named functions make the pipeline explicit and reusable."
  };

  function clearActive(){
    document.querySelectorAll(".hl.active").forEach(el => el.classList.remove("active"));
  }

  function onHighlightClick(e){
    const el = e.currentTarget;
    clearActive();
    el.classList.add("active");
    const key = el.dataset.map || "";
    explain.textContent = EXPL[key] || "…";
  }

  document.querySelectorAll(".hl").forEach(el => {
    el.addEventListener("click", onHighlightClick);
  });

  let midOn = false;

</script>
</body>
</html>
